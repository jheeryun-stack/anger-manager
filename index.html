<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>anger manager</title>
<style>
  :root{--bag-w:100px;--bag-h:320px;}
  html,body{
    height:100%;margin:0;background:#fff;color:#000;overflow:hidden;
    font-family:'Arial Black', sans-serif;
  }

  #intro {
    position:fixed;
    inset:0;
    background:#000;
    display:flex;
    justify-content:center;
    align-items:flex-end;
    z-index:9999;
    overflow:hidden;
  }
  #liquid {
    position:absolute;
    bottom:0; left:0;
    width:100%; height:0%;
    background:red;
    animation: fillUp 3s forwards;
  }
  @keyframes fillUp {
    from { height:0%; }
    to   { height:100%; }
  }

  #whiteScreen {
    position:absolute;
    inset:0;
    background:#fff;
    opacity:0;
    z-index:9000;
    transition: opacity 1s;
  }

  #intro.hidden { display:none; }

  .mark {
    position:absolute; top:10px; left:20px;
    font-size:60px; font-weight:900;
    display:flex; align-items:center;
  }
  .mark .fire { color:red; }
  .mark .colon { color:#000; margin-left:10px; }

  .stage {
    height:100%; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; padding-top:60px;
  }
  .bar { width:220px; height:12px; background:#000; margin-bottom:4px;}
  .bagWrapper {
    position:relative; width:var(--bag-w); height:calc(var(--bag-h) + 110px);
    transform-origin: top center;
    display:flex; flex-direction:column; align-items:center;
  }
  .rope {
    width:6px; height:110px; background:#000;
    transform-origin: top center;
  }
  .bag {
    width:var(--bag-w); height:var(--bag-h);
    background:#000;
    display:flex; align-items:center; justify-content:center;
    padding:20px;
    color:#fff; font-weight:900; text-align:center; font-size:18px;
    transform-origin: top center;
  }
  body, .bag { cursor: url('glove.png') 12 12, auto; }

  @keyframes bagSwing {
    0%{transform:rotate(0deg);}
    15%{transform:rotate(var(--angle,60deg));}
    30%{transform:rotate(calc(var(--angle,60deg) * -0.8));}
    45%{transform:rotate(calc(var(--angle,60deg) * 0.6));}
    60%{transform:rotate(calc(var(--angle,60deg) * -0.4));}
    75%{transform:rotate(calc(var(--angle,60deg) * 0.2));}
    100%{transform:rotate(0deg);}
  }
  @keyframes ropeSwing {
    0%{transform:rotate(0deg);}
    15%{transform:rotate(calc(var(--angle,35deg)));} 
    30%{transform:rotate(calc(var(--angle,35deg) * -0.8));}
    45%{transform:rotate(calc(var(--angle,35deg) * 0.6));}
    60%{transform:rotate(calc(var(--angle,35deg) * -0.4));}
    75%{transform:rotate(calc(var(--angle,35deg) * 0.2));}
    100%{transform:rotate(0deg);}
  }
  .hit .bag { animation: bagSwing 1s cubic-bezier(.2,.8,.2,1);}
  .hit .rope { animation: ropeSwing 1s cubic-bezier(.2,.8,.2,1);}

  .dust {
    position:fixed; width:4px; height:4px; background:#000;
    pointer-events:none; z-index:999;
    animation:dustFly 0.9s forwards;
  }
  @keyframes dustFly {
    from {transform:translate(0,0) scale(1);opacity:1;}
    to {transform:translate(var(--dx), var(--dy)) scale(0.2);opacity:0;}
  }

  .fx {
    position:fixed; 
    pointer-events:none;
    font-family:'Arial', sans-serif;
    font-weight:700;
    color:#000; 
    z-index:5000;
    animation:fxMove 1.2s forwards;
    white-space:nowrap;
    opacity:1;
  }
  @keyframes fxMove {
    from { transform:translate(0,0) scale(1); opacity:1;}
    to   { transform:translate(var(--dx), var(--dy)) scale(var(--s)); opacity:0;}
  }

  .inputArea { 
    margin-top:60px; 
    text-align:left; 
    width:300px;
  }
  .inputArea label {
    display:block; margin:12px 0;
    font-family:'Arial', sans-serif; font-size:16px; font-weight:bold;
  }

  input[type=text], select {
    margin-top:4px;
    font-family:'Arial', sans-serif; 
    font-size:14px;
    font-weight:bold;
    border:2px solid #000;
    border-radius:0;
    padding:4px;
    width:100%;
    box-sizing:border-box;
    background:#fff;
    appearance:none;
    -webkit-appearance:none;
    -moz-appearance:none;
    box-shadow:none;
  }
  select {
    background-image: linear-gradient(45deg, #000 50%, transparent 50%),
                      linear-gradient(-45deg, #000 50%, transparent 50%);
    background-position: right 10px center, right 4px center;
    background-size: 6px 6px;
    background-repeat: no-repeat;
    padding-right: 20px;
  }

  input[type=range] {
    -webkit-appearance:none;
    width:100%;
    height:4px;
    background:#000;
    border:none;
    border-radius:0;
  }
  input[type=range]::-webkit-slider-thumb {
    -webkit-appearance:none;
    width:14px; height:14px;
    background:red;
    cursor:pointer;
    border:none;
    border-radius:0;
  }
  input[type=range]::-moz-range-thumb {
    width:14px; height:14px;
    background:red;
    cursor:pointer;
    border:none;
    border-radius:0;
  }
</style>
</head>
<body>

<div id="intro">
  <div id="liquid"></div>
  <div id="whiteScreen"></div>
</div>

<div class="mark">
  <div class="fire">火</div>
  <div class="colon">:</div>
</div>

<div class="stage">
  <div class="bar"></div>
  <div class="bagWrapper" id="bagWrapper">
    <div class="rope" id="rope"></div>
    <div class="bag" id="bag">???</div>
  </div>

  <div class="inputArea">
    <label>
      당신을 스트레스받게 하는 대상을 입력해주세요:
      <input type="text" id="targetInput" placeholder="예: 직장상사" oninput="bag.innerText=this.value">
    </label>

    <label>
      분노 게이지:
      <select id="angerLevel" onchange="updateAngerColor()">
        <option value="#ff9999">1</option>
        <option value="#ff3333">2</option>
        <option value="#990000">3</option>
        <option value="#660000">4</option>
        <option value="#000000">MAX</option>
      </select>
    </label>

    <label>
      타격감:
      <input type="range" id="impactRange" min="1" max="5" value="3" oninput="impact=this.value">
    </label>
  </div>
</div>

<audio id="hitSound" src="https://www.soundjay.com/human/sounds/punch-1.mp3" preload="auto"></audio>

<script>
const whiteScreen = document.getElementById("whiteScreen");

setTimeout(()=>{
  whiteScreen.style.opacity=1;
}, 3000);

setTimeout(()=>{
  document.getElementById('intro').classList.add('hidden');
}, 4500);

const bagWrapper=document.getElementById('bagWrapper');
const bag=document.getElementById('bag');
const hitSound=document.getElementById('hitSound');
let impact=3; 

function updateAngerColor(){
  bag.style.background=document.getElementById('angerLevel').value;
}

bag.onclick=function(){
  hitSound.currentTime=0;
  hitSound.play();

  const maxAngle = 180;
  const angle = (impact/5) * maxAngle;
  bagWrapper.style.setProperty('--angle', angle+"deg");

  bagWrapper.classList.add('hit');
  setTimeout(()=>bagWrapper.classList.remove('hit'),1000);

  const rect=bag.getBoundingClientRect();
  const cx=rect.left+rect.width/2;
  const cy=rect.top+rect.height/2;

  for(let i=0;i<impact*6;i++){
    const d=document.createElement('div');
    d.className='dust';
    d.style.left=cx+'px';
    d.style.top=cy+'px';
    d.style.setProperty('--dx',(Math.random()*impact*80-impact*40)+'px');
    d.style.setProperty('--dy',(Math.random()*impact*60-impact*30)+'px');
    document.body.appendChild(d);
    setTimeout(()=>d.remove(),900);
  }

  spawnFx("(퍽)", cx, cy, impact);
  spawnFx("(^_^)", cx, cy, impact);
}

function spawnFx(txt, x, y, level){
  const f=document.createElement("div");
  f.className="fx";
  f.innerText=txt;
  f.style.left=x+"px";
  f.style.top=y+"px";

  const sizeBase = (txt==="(퍽)") ? 24 : 18;
  const size = sizeBase + level*4;
  f.style.fontSize=size+"px";

  const dx=(Math.random()*level*120-level*60)+"px";
  const dy=(Math.random()*level*80-level*40)+"px";
  f.style.setProperty('--dx', dx);
  f.style.setProperty('--dy', dy);

  const s=(Math.random()*0.6+0.8).toFixed(2);
  f.style.setProperty('--s', s);

  document.body.appendChild(f);
  setTimeout(()=>f.remove(),1200);
}
</script>
</body>
</html>
